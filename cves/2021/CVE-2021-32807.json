{"Modified":"2022-12-02T19:36:00","Published":"2021-07-30T22:15:00","access":{"authentication":"SINGLE","complexity":"LOW","vector":"NETWORK"},"assigner":"security-advisories@github.com","capec":[],"cvss":6.5,"cvss-time":"2022-12-02T19:36:00","cvss-vector":"AV:N/AC:L/Au:S/C:P/I:P/A:P","cwe":"CWE-1321","id":"CVE-2021-32807","impact":{"availability":"PARTIAL","confidentiality":"PARTIAL","integrity":"PARTIAL"},"last-modified":"2022-12-02T19:36:00","references":["https://github.com/zopefoundation/AccessControl/blob/master/CHANGES.rst#51-2021-07-30","https://github.com/zopefoundation/AccessControl/commit/b42dd4badf803bb9fb71ac34cd9cb0c249262f2c","https://github.com/zopefoundation/AccessControl/security/advisories/GHSA-qcx9-j53g-ccgf"],"summary":"The module `AccessControl` defines security policies for Python code used in restricted code within Zope applications. Restricted code is any code that resides in Zope's object database, such as the contents of `Script (Python)` objects. The policies defined in `AccessControl` severely restrict access to Python modules and only exempt a few that are deemed safe, such as Python's `string` module. However, full access to the `string` module also allows access to the class `Formatter`, which can be overridden and extended within `Script (Python)` in a way that provides access to other unsafe Python libraries. Those unsafe Python libraries can be used for remote code execution. By default, you need to have the admin-level Zope \"Manager\" role to add or edit `Script (Python)` objects through the web. Only sites that allow untrusted users to add/edit these scripts through the web - which would be a very unusual configuration to begin with - are at risk. The problem has been fixed in AccessControl 4.3 and 5.2. Only AccessControl versions 4 and 5 are vulnerable, and only on Python 3, not Python 2.7. As a workaround, a site administrator can restrict adding/editing `Script (Python)` objects through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing these scripts through the web should be restricted to trusted users only. This is the default configuration in Zope.","vulnerable_configuration":[{"id":"cpe:2.3:a:zope:accesscontrol:5.0:*:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:5.0:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:5.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:5.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:-:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:-:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha1:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha2:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha3:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha4:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha5:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha5:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha6:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha6:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:alpha7:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:alpha7:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta1:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta1:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta2:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta2:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta3:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta3:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta4:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta4:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta5:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta5:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta6:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta6:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.0:beta7:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.0:beta7:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.1:*:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.1:*:*:*:*:*:*:*"},{"id":"cpe:2.3:a:zope:accesscontrol:4.2:*:*:*:*:*:*:*","title":"cpe:2.3:a:zope:accesscontrol:4.2:*:*:*:*:*:*:*"}],"vulnerable_configuration_cpe_2_2":[],"vulnerable_product":["cpe:2.3:a:zope:accesscontrol:5.0:*:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:5.1:*:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:-:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha1:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha2:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha3:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha4:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha5:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha6:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:alpha7:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta1:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta2:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta3:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta4:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta5:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta6:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.0:beta7:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.1:*:*:*:*:*:*:*","cpe:2.3:a:zope:accesscontrol:4.2:*:*:*:*:*:*:*"]}